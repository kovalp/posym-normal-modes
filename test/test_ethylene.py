import numpy as np

from posym_normal_modes import SymmetryModes

modes = np.array(
    [
        [[2.18825062e-17, -6.16903362e-03, -7.70981747e-02],
         [-2.16191340e-17, -6.16903362e-03, -7.70981747e-02],
         [-2.85943306e-03, 3.67475484e-02, 4.59365243e-01],
         [2.85943306e-03, 3.67475484e-02, 4.59365243e-01],
         [-2.85943306e-03, 3.67475484e-02, 4.59365243e-01],
         [2.85943306e-03, 3.67475484e-02, 4.59365243e-01]],

        [[2.11328460e-17, -3.92641181e-02, 3.52588474e-03],
         [2.79901343e-17, -3.92641181e-02, 3.52588474e-03],
         [-4.28470697e-01, 2.33941764e-01, -2.09974803e-02],
         [4.28470697e-01, 2.33941764e-01, -2.09974803e-02],
         [-4.28470697e-01, 2.33941764e-01, -2.09974803e-02],
         [4.28470697e-01, 2.33941764e-01, -2.09974803e-02]],

        [[1.55980321e-17, -9.43828919e-03, -1.22413227e-01],
         [6.16792088e-17, 9.43828919e-03, 1.22413227e-01],
         [-1.67449465e-04, 3.04075341e-02, 3.96588343e-01],
         [1.67449465e-04, 3.04075341e-02, 3.96588343e-01],
         [1.67449465e-04, -3.04075341e-02, -3.96588343e-01],
         [-1.67449465e-04, -3.04075341e-02, -3.96588343e-01]],

        [[8.24137470e-06, -4.47897281e-15, 2.96121032e-16],
         [8.24137470e-06, 4.61189699e-15, -1.48552946e-16],
         [-4.91018833e-05, 3.80575166e-02, 4.96555632e-01],
         [-4.91018832e-05, -3.80575166e-02, -4.96555632e-01],
         [-4.91018832e-05, 3.80575166e-02, 4.96555632e-01],
         [-4.91018833e-05, -3.80575166e-02, -4.96555632e-01]],

        [[6.69820258e-17, 1.22809208e-01, -9.45971985e-03],
         [3.10508250e-17, -1.22809208e-01, 9.45971985e-03],
         [3.81636218e-01, -1.09118343e-01, 8.54427908e-03],
         [-3.81636218e-01, -1.09118343e-01, 8.54427908e-03],
         [-3.81636218e-01, 1.09118343e-01, -8.54427908e-03],
         [3.81636218e-01, 1.09118343e-01, -8.54427908e-03]],

        [[8.34957994e-02, -8.70943376e-17, -4.00553197e-17],
         [-8.34957994e-02, -1.08607258e-16, 7.53168089e-17],
         [4.17651940e-01, -1.78493455e-01, 1.36917689e-02],
         [4.17651940e-01, 1.78493455e-01, -1.36917689e-02],
         [-4.17651940e-01, 1.78493455e-01, -1.36917689e-02],
         [-4.17651940e-01, -1.78493455e-01, 1.36917689e-02]],

        [[-6.52857316e-02, 7.30791569e-17, 3.19963843e-17],
         [-6.52857316e-02, -1.96867125e-17, 9.76090215e-17],
         [3.88967356e-01, -2.66286039e-01, 2.04538813e-02],
         [3.88967356e-01, 2.66286039e-01, -2.04538813e-02],
         [3.88967356e-01, -2.66286039e-01, 2.04538813e-02],
         [3.88967356e-01, 2.66286039e-01, -2.04538813e-02]],

        [[1.77514968e-01, 1.60173494e-17, 9.64671574e-17],
         [-1.77514968e-01, 3.79682961e-17, -6.07063801e-19],
         [-1.19510373e-01, 2.13831173e-01, -1.63891033e-02],
         [-1.19510373e-01, -2.13831173e-01, 1.63891033e-02],
         [1.19510373e-01, -2.13831173e-01, 1.63891033e-02],
         [1.19510373e-01, 2.13831173e-01, -1.63891033e-02]],

        [[-4.14804463e-02, -4.80520483e-17, -1.66850316e-17],
         [-4.14804463e-02, -1.01194713e-16, 1.20780634e-17],
         [2.47134365e-01, 4.19117220e-01, -3.20938643e-02],
         [2.47134365e-01, -4.19117220e-01, 3.20938643e-02],
         [2.47134365e-01, 4.19117220e-01, -3.20938643e-02],
         [2.47134365e-01, -4.19117220e-01, 3.20938643e-02]],

        [[-5.60838197e-02, -9.61040967e-17, 4.71265385e-17],
         [5.60838197e-02, 1.34089236e-16, -1.43397077e-17],
         [2.43515914e-01, 4.11078041e-01, -3.14796134e-02],
         [2.43515914e-01, -4.11078041e-01, 3.14796134e-02],
         [-2.43515914e-01, -4.11078041e-01, 3.14796134e-02],
         [-2.43515914e-01, 4.11078041e-01, -3.14796134e-02]],

        [[6.68910347e-17, -6.68151446e-02, 5.11638961e-03],
         [-1.35681371e-16, 6.68151446e-02, -5.11638961e-03],
         [2.44162261e-01, 4.00880239e-01, -3.06982156e-02],
         [-2.44162261e-01, 4.00880239e-01, -3.06982156e-02],
         [-2.44162261e-01, -4.00880239e-01, 3.06982156e-02],
         [2.44162261e-01, -4.00880239e-01, 3.06982156e-02]],

        [[-2.43547820e-17, 6.63559058e-02, -5.08138639e-03],
         [-9.79684941e-17, 6.63559058e-02, -5.08138639e-03],
         [-2.53812054e-01, -3.95337816e-01, 3.02737591e-02],
         [2.53812054e-01, -3.95337816e-01, 3.02737591e-02],
         [-2.53812054e-01, -3.95337816e-01, 3.02737591e-02],
         [2.53812054e-01, -3.95337816e-01, 3.02737591e-02]]])

positions = np.array([[-0.668, 0., 0.],
                      [0.668, 0., 0.],
                      [-1.228, -0.927, 0.071],
                      [-1.228, 0.927, -0.071],
                      [1.228, 0.927, -0.071],
                      [1.228, -0.927, 0.071]])

symbols = ['C', 'C', 'H', 'H', 'H', 'H']


def test_ethylene() -> None:
    """."""
    sym_modes_gs = SymmetryModes(group='d2h', coordinates=positions, modes=modes, symbols=symbols)

    print()
    for i, mode_x in enumerate(modes):
        print(i + 6, sym_modes_gs.get_state_mode(i))
