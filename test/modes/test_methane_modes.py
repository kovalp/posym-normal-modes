import numpy as np
from posym_normal_modes import SymmetryModes

modes = np.array([[[-3.26837294e-01, -1.15073896e-01, 5.53206084e-02],
                   [6.55637417e-02, -8.63965808e-02, -1.14545937e-02],
                   [-1.45221847e-01, 5.10377196e-01, 5.69982153e-02],
                   [-1.77305410e-01, 3.33053409e-01, 3.21625994e-01],
                   [-1.31918788e-01, 3.01173273e-01, -2.97447945e-01]],

                  [[4.41989326e-01, -7.61334689e-02, -6.39084823e-02],
                   [-8.55669325e-02, -6.65344948e-02, 1.20708316e-02],
                   [-1.80828365e-01, 1.11665884e-01, -5.68420226e-02],
                   [4.07001922e-01, 3.59453527e-01, -1.10905567e-01],
                   [3.51480726e-01, 3.97861080e-01, 8.78158237e-02]],

                  [[8.42612163e-02, -1.63555416e-04, 5.49767806e-01],
                   [-1.65496537e-02, 1.73023815e-03, -1.07783384e-01],
                   [-1.68993250e-04, -3.99943324e-02, 5.50381787e-01],
                   [-2.10689934e-01, 1.93287002e-01, 5.53034607e-02],
                   [3.23809240e-01, -1.73747232e-01, 1.28931535e-01]],

                  [[-4.87728206e-01, -7.17589519e-03, 1.00790972e-01],
                   [1.32048044e-05, 1.43534769e-06, 4.67725598e-06],
                   [-1.70012206e-01, 4.58953093e-01, -9.21160877e-02],
                   [3.80584881e-01, -1.45107179e-01, -2.86520295e-01],
                   [2.76998174e-01, -3.06687123e-01, 2.77789676e-01]],

                  [[1.00864979e-01, -1.32725473e-03, 4.87706001e-01],
                   [-8.02267137e-06, -8.12621671e-06, -2.60514562e-06],
                   [2.86185029e-02, -8.75988850e-02, -4.89397735e-01],
                   [2.12484425e-01, 4.46988551e-01, 5.59168413e-02],
                   [-3.41872305e-01, -3.57965579e-01, -5.41940646e-02]],

                  [[-6.75925728e-03, 4.97885638e-01, 2.74180273e-03],
                   [-4.99425854e-06, 7.27191954e-06, -2.05913537e-07],
                   [-4.67188537e-01, -1.72378954e-01, 3.51978579e-03],
                   [2.40891293e-01, -1.64996681e-01, 4.03511188e-01],
                   [2.33125211e-01, -1.60610052e-01, -4.09769942e-01]],

                  [[1.80558203e-03, -1.47214564e-02, -1.75620192e-02],
                   [-8.70669693e-03, 1.09274322e-03, 9.46163262e-02],
                   [6.81384833e-02, 2.43458229e-02, -1.79817030e-02],
                   [-2.90622734e-01, 1.99958792e-01, -5.06983332e-01],
                   [3.24425404e-01, -2.22604110e-01, -5.84897380e-01]],

                  [[1.96718915e-02, -2.01720011e-01, 5.23596820e-04],
                   [-9.19389413e-02, 2.23712505e-02, -8.71968466e-03],
                   [6.33946965e-01, 2.23503556e-01, -3.03608494e-03],
                   [2.55923962e-01, -1.67792911e-01, 4.01852469e-01],
                   [1.85977520e-01, -1.20561558e-01, -2.95438474e-01]],

                  [[6.34117510e-03, -7.88518040e-01, -4.43120845e-03],
                   [2.23755871e-02, 9.23448515e-02, 9.92570920e-04],
                   [-4.20506338e-01, -1.70686714e-01, 2.95341676e-03],
                   [7.27370103e-02, -6.97142547e-02, 1.28582037e-01],
                   [7.48027873e-02, -7.14414823e-02, -1.38931514e-01]]])

positions = np.array([[2.1000e-03, -4.1000e-03, 2.0000e-03],
                      [-1.2700e-02, 1.0858e+00, 8.0000e-03],
                      [1.0099e+00, 1.4631e+00, 3.0000e-04],
                      [-5.3990e-01, 1.4469e+00, -8.7510e-01],
                      [-5.2290e-01, 1.4373e+00, 9.0480e-01]])

symbols = ['H', 'C', 'H', 'H', 'H']


def test_methane() -> None:
    """."""
    sym_modes_gs = SymmetryModes(group='td', coordinates=positions, modes=modes, symbols=symbols)

    print()
    for i, mode_x in enumerate(modes):
        print(i + 6, sym_modes_gs.get_state_mode(i))
