import numpy as np

from posym_normal_modes import SymmetryModes

modes = np.array([[[-1.95139113e-17, -2.55144388e-02, 5.07115327e-02],
                   [-2.80303615e-17, -2.55144388e-02, 5.07115327e-02],
                   [0.00000000e+00, 3.04044940e-01, -6.04308214e-01],
                   [-2.76452150e-17, 3.04044940e-01, -6.04308214e-01]],

                  [[-8.95970759e-18, -5.07115327e-02, -2.55144388e-02],
                   [-2.80303615e-17, -5.07115327e-02, -2.55144388e-02],
                   [0.00000000e+00, 6.04308214e-01, 3.04044940e-01],
                   [-6.91130376e-18, 6.04308214e-01, 3.04044940e-01]],

                  [[-6.79923181e-21, 1.19384807e-01, 4.47096350e-02],
                   [4.00433736e-17, -1.19384807e-01, -4.47096350e-02],
                   [0.00000000e+00, -5.14965139e-01, -1.92854551e-01],
                   [2.76452150e-17, 5.14965139e-01, 1.92854551e-01]],

                  [[2.71875102e-17, 4.47096350e-02, -1.19384807e-01],
                   [2.80303615e-17, -4.47096350e-02, 1.19384807e-01],
                   [2.76452150e-17, -1.92854551e-01, 5.14965139e-01],
                   [5.52904301e-17, 1.92854551e-01, -5.14965139e-01]],

                  [[1.89514297e-01, 4.80520483e-17, 3.20346989e-17],
                   [-1.89514297e-01, -1.14672489e-17, -2.22991718e-18],
                   [2.60906732e-01, -6.38664801e-17, -1.61494439e-17],
                   [-2.60906732e-01, 3.84414857e-17, 7.88486551e-18]],

                  [[-5.67723500e-02, 3.20346989e-17, 0.00000000e+00],
                   [-5.67723500e-02, -9.29197674e-19, 1.76237995e-18],
                   [6.76480849e-01, -8.21339288e-18, 7.28436078e-18],
                   [6.76480849e-01, 3.92381664e-18, -1.12069370e-19]],

                  [[7.55833205e-02, -3.20346989e-17, -1.60173494e-17],
                   [-7.55833205e-02, 1.13928901e-18, 1.29708815e-18],
                   [-6.54186077e-01, 5.02026776e-18, 5.61756960e-18],
                   [6.54186077e-01, -2.87685645e-18, -3.68829441e-19]]])

positions = np.array([[-0.603, 0., 0.],
                      [0.603, 0., 0.],
                      [-1.661, 0., 0.],
                      [1.661, 0., 0.]])

symbols = ['C', 'C', 'H', 'H']


def test_acetylene() -> None:
    """Fails. Because no infinity? """
    sym_modes_gs = SymmetryModes(group='d*h', coordinates=positions, modes=modes, symbols=symbols)

    print()
    for i, mode_x in enumerate(modes):
        print(i + 5, sym_modes_gs.get_state_mode(i))
